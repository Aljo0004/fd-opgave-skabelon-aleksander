---
import type { ImageMetadata } from "astro";
import { getImage } from "astro:assets";
const { imagePath, class: className } = Astro.props;

const importedImage = `/src/assets/images/${imagePath}`;

const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/images/*.{jpeg,jpg,png,gif,webp}");
if (!images[importedImage]) throw new Error(`"${importedImage}" does not exist in glob: "src/assets/images/*.{jpeg,jpg,png,gif,webp}"`);

const optimizedBackground = await getImage({
  src: images[importedImage](),
  format: "webp",
});
---

<section style={`background-image: url(${optimizedBackground.src});`} class={className}>
  <slot />
</section>

<style>
  section {
    display: grid;
    grid-template-columns: 1fr 1fr 2fr;
    grid-template-rows: 1fr 1fr 1fr;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    margin-top: -2rem;
  }
  @media (max-width: 800px) {
    section {
      grid-template-columns: 1fr;
      grid-template-rows: auto auto auto;
      background-size: cover;
      background-position: top;
      margin-top: 0;
    }
  }
</style>
